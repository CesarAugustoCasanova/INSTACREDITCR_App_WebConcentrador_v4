<!DOCTYPE html>
<html>
<head>
    <title>Calculadora</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="Estilos/w3.css" />
    <script src="JS/iFrameMejorado.js?v=2" type="text/javascript"></script>
    <script type="text/javascript">
        var operandoa;
        var operandob;
        var operacion;
        function init() {
            var resultado = document.getElementById('resultado');
            var reset = document.getElementById('reset');
            var suma = document.getElementById('suma');
            var resta = document.getElementById('resta');
            var multiplicacion = document.getElementById('multiplicacion');
            var division = document.getElementById('division');
            var igual = document.getElementById('igual');
            var uno = document.getElementById('uno');
            var dos = document.getElementById('dos');
            var tres = document.getElementById('tres');
            var cuatro = document.getElementById('cuatro');
            var cinco = document.getElementById('cinco');
            var seis = document.getElementById('seis');
            var siete = document.getElementById('siete');
            var ocho = document.getElementById('ocho');
            var nueve = document.getElementById('nueve');
            var cero = document.getElementById('cero');
            var punto = document.getElementById('punto');
            //Eventos de click
            uno.onclick = function (e) {
                resultado.textContent = resultado.textContent + "1";
            }
            dos.onclick = function (e) {
                resultado.textContent = resultado.textContent + "2";
            }
            tres.onclick = function (e) {
                resultado.textContent = resultado.textContent + "3";
            }
            cuatro.onclick = function (e) {
                resultado.textContent = resultado.textContent + "4";
            }
            cinco.onclick = function (e) {
                resultado.textContent = resultado.textContent + "5";
            }
            seis.onclick = function (e) {
                resultado.textContent = resultado.textContent + "6";
            }
            siete.onclick = function (e) {
                resultado.textContent = resultado.textContent + "7";
            }
            ocho.onclick = function (e) {
                resultado.textContent = resultado.textContent + "8";
            }
            nueve.onclick = function (e) {
                resultado.textContent = resultado.textContent + "9";
            }
            cero.onclick = function (e) {
                resultado.textContent = resultado.textContent + "0";
            }
            punto.onclick = function (e) {
                if ( !resultado.textContent.includes(".")) {
                    resultado.textContent = resultado.textContent + ".";
                }
            }
            reset.onclick = function (e) {
                limpiar();
                resetear();
            }
            suma.onclick = function (e) {
                operandoa = resultado.textContent;
                operacion = "+";
                limpiar();
            }
            resta.onclick = function (e) {
                operandoa = resultado.textContent;
                operacion = "-";
                limpiar();
            }
            multiplicacion.onclick = function (e) {
                operandoa = resultado.textContent;
                operacion = "*";
                limpiar();
            }
            division.onclick = function (e) {
                operandoa = resultado.textContent;
                operacion = "/";
                limpiar();
            }
            igual.onclick = function (e) {
                operandob = resultado.textContent;
                resultado.textContent = resolver();
                resetear();
            }
        }
        function limpiar() {
            resultado.textContent = "";
        }
        function resetear() {
            operandoa = null;
            operandob = null;
            operacion = null;
        }
        function resolver() {
            var res = 0;
            switch (operacion) {
                case "+":
                    res = parseFloat(operandoa) + parseFloat(operandob);
                    break;
                case "-":
                    res = parseFloat(operandoa) - parseFloat(operandob);
                    break;
                case "*":
                    res = parseFloat(operandoa) * parseFloat(operandob);
                    break;
                case "/":
                    res = parseFloat(operandoa) / parseFloat(operandob);
                    break;
            }
            return res;
        }
        function detectaTecla(e) {
            try {
                if (!isNaN(Number(e.key))) {
                    resultado.textContent = resultado.textContent + e.key;
                }
                else if (e.key == "." && !resultado.textContent.includes(".")) {
                    resultado.textContent = resultado.textContent + e.key;
                }
                else if (e.key == "+" || e.key == "-" || e.key == "*" || e.key == "/") {

                    if (operandoa == null) {
                        operandoa = resultado.textContent;
                    }
                    if (operacion == null) {
                        operacion = e.key;
                        limpiar();
                    }
                    else {
                        operandob = resultado.textContent;
                        operandoa = resolver();
                        operacion = e.key;
                        resultado.textContent = ""
                        operandob = null;
                    }

                }
                else if (e.key == "=" || e.key == "Enter") {
                    operandob = resultado.textContent;
                    resultado.textContent = resolver();
                    resetear();
                }
                else if (e.key == "Backspace" && resultado.textContent.length > 0) {

                    resultado.textContent = resultado.textContent.substring(0, resultado.textContent.length - 1);

                }
                else if (e.key == "Delete") {
                    limpiar();
                    resetear();
                }
            } catch (ex) {

            }
        }
    </script>
</head>
<body onload="init();" onkeydown="detectaTecla(event)" class="w3-container w3-padding-16" onmousemove="window.parent.movement();" autofocus="true">
    <!-- Calculadora -->
    <table style="border-collapse: collapse;">
        <tr class="w3-border">
            <td colspan="4"><span id="resultado" class="w3-white w3-block w3-padding" style="min-height:55px; MAX-width:180px; overflow:auto;"></span></td>
        </tr>
        <tr class="w3-border">
            <td class="w3-border">
                <button id="siete" class="w3-button">7</button>
            </td>
            <td class="w3-border">
                <button id="ocho" class="w3-button">8</button>
            </td>
            <td class="w3-border">
                <button id="nueve" class="w3-button">9</button>
            </td>
            <td class="w3-border">
                <button id="division" class="w3-button">/</button>
            </td>
        </tr>
        <tr class="w3-border">
            <td class="w3-border">
                <button id="cuatro" class="w3-button">4</button>
            </td>
            <td class="w3-border">
                <button id="cinco" class="w3-button">5</button>
            </td>
            <td class="w3-border">
                <button id="seis" class="w3-button">6</button>
            </td>
            <td class="w3-border">
                <button id="multiplicacion" class="w3-button">*</button>
            </td>
        </tr>
        <tr class="w3-border">
            <td class="w3-border">
                <button id="uno" class="w3-button">1</button>
            </td>
            <td class="w3-border">
                <button id="dos" class="w3-button">2</button>
            </td>
            <td class="w3-border">
                <button id="tres" class="w3-button">3</button>
            </td>
            <td class="w3-border">
                <button id="resta" class="w3-button">-</button>
            </td>
        </tr>
        <tr class="w3-border">
            <td class="w3-border">
                <button id="reset" class="w3-button">C</button>
            </td>
            <td class="w3-border">
                <button id="cero" class="w3-button">0</button>
            </td>
            <td class="w3-border">
                <button id="punto" class="w3-button">.</button>
            </td>
            <td class="w3-border">
                <button id="suma" class="w3-button">+</button>
            </td>
        </tr>
        <tr class="w3-border">
            <td class="w3-border">
                
            </td>
            <td class="w3-border">
                
            </td>
            <td class="w3-border">
                 
            </td>
            <td class="w3-border">
                <button id="igual" class="w3-button">=</button>
            </td>
        </tr>
    </table>
</body>
</html>
